<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TuRifa2025 — Sorteo SUPER GANA $1,000</title>

  <!-- SEO / Social meta -->
  <meta name="description" content="Participa en el sorteo SUPER GANA: premio principal $1,000 en efectivo. Compra boletos en USD o Bs, transmisión en vivo y verificación pública del resultado. Soporte: validación entre 12-24 horas." />
  <meta name="robots" content="index, follow" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="TuRifa2025 — Sorteo SUPER GANA $1,000" />
  <meta property="og:description" content="Participa en el sorteo SUPER GANA: premio principal $1,000 en efectivo. Compra boletos en USD o Bs, transmisión en vivo y verificación pública del resultado." />
  <meta property="og:image" content="{{ url_for('static', filename='efectivo.png') }}" />
  <meta property="og:site_name" content="TuRifa2025" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="TuRifa2025 — Sorteo SUPER GANA $1,000" />
  <meta name="twitter:description" content="Participa en el sorteo SUPER GANA: premio principal $1,000 en efectivo. Compra boletos en USD o Bs, transmisión en vivo y verificación pública del resultado." />
  <meta name="twitter:image" content="{{ url_for('static', filename='efectivo.png') }}" />

  <!-- JSON-LD structured data (Organization/Event) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Event",
    "name": "Sorteo SUPER GANA",
    "description": "Sorteo público con verificación y transmisión en vivo. Premio principal $1,000 en efectivo.",
    "location": {
      "@type": "VirtualLocation",
      "url": "{{ request.url_root }}"
    },
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD",
      "availability": "https://schema.org/InStock"
    }
  }
  </script>

  <!-- Estilos -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="icon" href="/favicon.ico" />

  <style>
    /* Barra de progreso mínima y accesible */
    #sales-progress {
      position: relative;
      height: 18px;
      background: #e6e6e6;
      border-radius: 999px;
      overflow: hidden;
    }
    #sales-progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg,#ff7a18,#ffb347);
      box-shadow: 0 0 18px rgba(255,123,24,0.12);
      transition: width 700ms ease-out;
    }
    #sales-progress-markers span {
      position: absolute;
      top: -4px;
      height: 26px;
      width: 1px;
      background: rgba(255,255,255,0.35);
    }
    .ticket-btn {
      background: #fff;
      border: 1px solid #ddd;
      padding: 6px 8px;
      border-radius: 6px;
      cursor: pointer;
      font-family: monospace;
      text-align: center;
    }
    .ticket-btn.selected {
      background: linear-gradient(90deg,#ff7a18,#ffb347);
      color: #fff;
      box-shadow: 0 4px 14px rgba(255,123,24,0.12);
      border-color: rgba(255,123,24,0.6);
    }
  </style>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    emailjs.init('p9hLWmmvXjeTINrFL');
  </script>

  <!-- Firebase SDK (modular) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDkq6BtLENRPP4MoSsyG3sn_18z7WdhzQ",
      authDomain: "turifa2025-7f3f1.firebaseapp.com",
      databaseURL: "https://turifa2025-7f3f1-default-rtdb.firebaseio.com",
      projectId: "turifa2025-7f3f1",
      storageBucket: "turifa2025-7f3f1.appspot.com",
      messagingSenderId: "788208791145",
      appId: "1:788208791145:web:8611671eb1b8196c4a5a78",
      measurementId: "G-F1YWVCMMJXP"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    window.firebaseDB = db;
    window.firebaseRef = ref;
    window.firebaseSet = set;
    window.firebaseGet = get;
    window.firebaseChild = child;
  </script>

  <!-- Script principal -->
  <script type="module" src="{{ url_for('static', filename='app.js') }}"></script>
</head>
<body>

  <!-- Logo -->
  <header>
    <img src="{{ url_for('static', filename='Logo.png') }}" alt="Logo Turifa2025" class="logo" />
    <div style="flex:1">
      <h1 style="font-size:20px;letter-spacing:1px;margin-bottom:4px">Turifa2025</h1>
      <div style="font-size:12px;color:rgba(255,255,255,0.6)">Sorteo: PRÓXIMAMENTE — anunciaremos el día oficial</div>
    </div>
  <a class="btn-primary" href="#premios" style="white-space:nowrap">Seleccionar boletos</a>
  <!-- Botón de admin visible públicamente (requiere login en /admin) -->
  <a class="btn-admin" href="/admin" style="margin-left:10px; padding:8px 10px; background:transparent; border:1px solid rgba(255,255,255,0.12); color:inherit; border-radius:8px; text-decoration:none; font-size:13px;">Admin</a>
  </header>

  <!-- Navegación -->
  <nav>
    <ul>
      <li><a href="#" id="btn-premios">PREMIOS</a></li>
      <li><a href="#" id="btn-preguntas">PREGUNTAS</a></li>
      <li><a href="#" id="btn-contacto">CONTACTO</a></li>
    </ul>
  </nav>

  <!-- Contenido principal -->
  <main>
    <!-- Premios -->
    <section id="premios" style="display:flex;gap:28px;align-items:center;justify-content:space-between;">
      <div style="flex:1">
    <h1 style="font-size:40px;line-height:1">SUPER COMBO GANA</h1>
  <p class="animated-text" style="font-size:20px;margin-top:6px"><strong>SUPER GANA — premio principal: $1,000</strong></p>
  <p style="margin-top:12px;color:rgba(255,255,255,0.8)">Compra tus boletos en USD o Bs y participa en el sorteo público de <strong>SUPER GANA</strong>. Transmisión en vivo y verificación pública del seed aleatorio.</p>
  <p style="margin-top:8px;color:rgba(255,255,255,0.7);font-size:14px">Soporte: La validación de tu participación puede tardar entre <strong>12 a 24 horas</strong>.</p>
        <div style="margin-top:18px"><a class="btn-primary" href="#ticket-grid">Seleccionar boletos</a></div>
      </div>
      <div style="width:46%">
        <div class="card-3d" style="padding:18px;border-radius:14px;">
          <img src="{{ url_for('static', filename='efectivo.png') }}" alt="Imagen del premio: $1,000 en efectivo" class="motos-img" aria-describedby="premio-desc" />
          <p id="premio-desc" class="sr-only">Premio principal: $1,000 USD en efectivo a entregar según las reglas del sorteo. Validación de participación: 12 a 24 horas.</p>
        </div>
      </div>
    </section>

    <!-- Progreso de ventas -->
    <section aria-labelledby="progreso-title" style="margin-top:18px;">
      <h2 id="progreso-title">Progreso de Ventas</h2>
      <div style="display:flex;gap:12px;align-items:center;justify-content:center;margin-bottom:8px;">
        <div style="font-size:13px;color:rgba(255,255,255,0.85)">Tasa: <strong id="rate-display">--</strong></div>
        <div style="font-size:11px;color:rgba(255,255,255,0.6)">Última actualización: <span id="rate-updated">--</span></div>
        <div id="rate-badge-container" style="margin-left:6px"></div>
      </div>
  <div id="sales-progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-label="Progreso de ventas">
        <div id="sales-progress-fill" aria-hidden="true"></div>
        <div id="sales-progress-markers" aria-hidden="true">
          <span style="left:25%"></span>
          <span style="left:50%"></span>
          <span style="left:75%"></span>
          <span style="left:100%"></span>
        </div>
      </div>
  <p class="text-xs text-muted-foreground" style="margin-top:6px;">¡Vamos <strong id="sales-pct">0%</strong>! Vendidos <span id="vendidos-count">0</span> / <span id="total-count">10000</span></p>
    </section>


  <!-- Selección de boletos -->
  <section class="section-card">
    <h2>BOLETOS DISPONIBLES</h2>

    <!-- Controles de paginación -->
    <div class="pagination-controls" style="display:flex;gap:12px;align-items:center;justify-content:center;margin-bottom:16px;">
      <button id="page-prev" class="btn-primary small">Anterior</button>
      <span>Página <span id="page-index">1</span></span>
      <select id="per-page">
        <option value="50">50 por página</option>
        <option value="100" selected>100 por página</option>
        <option value="200">200 por página</option>
      </select>
      <button id="page-next" class="btn-primary small">Siguiente</button>
    </div>

    <!-- Grid de boletos -->
    <div id="ticket-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(60px,1fr));gap:8px;max-height:400px;overflow-y:auto;padding:16px;border:1px solid #ddd;border-radius:8px;"></div>

    <div class="booking-grid">
    </div>
    <!-- Left: controls & form -->
    <aside class="booking-controls">
      <form id="boletos-form" aria-labelledby="ticket-grid">
        <div class="form-row">
          <label for="numero-boletos">Número de boletos (mínimo 2)</label>
          <input type="number" id="numero-boletos" name="numero-boletos" min="1" value="2" aria-describedby="numero-help" />
          <div id="numero-help" class="sr-only">Selecciona mínimo 2 boletos según reglas</div>
        </div>
        <div class="controls-row">
          <div class="left-controls">
            <button type="button" id="btn-azar" class="btn-primary small">Elegir boletos</button>
            <label for="currency">Moneda</label>
            <select id="currency">
              <option value="USD">USD</option>
              <option value="VES">Bs</option>
            </select>
          </div>
          <div class="right-controls" aria-live="polite">
            <div class="selected-count">Seleccionados: <strong id="boletos-seleccionados">0</strong></div>
          </div>
        </div>
        <div class="summary-row">
          <ul id="lista-numeros" aria-live="polite" class="picked-list"></ul>
          <div class="totals">Total: <span id="total-usd">0 USD</span> — <span id="total-bolivares">0</span> Bs</div>
        </div>
        <div class="payment-methods" style="margin-top: 16px;">
          <h3>Métodos de Pago</h3>
          <div style="display: flex; gap: 12px;">
            <button type="button" class="pay-icon btn-primary" data-pay="zelle" aria-label="Pagar con Zelle">Zelle</button>
            <button type="button" class="pay-icon btn-primary" data-pay="pagomovil" aria-label="Pagar con Pago Móvil">Pago Móvil</button>
          </div>
        </div>
      </form>
    </aside>

  </main>

  <!-- Pie de página -->
  <footer>
    <p>© 2025. Todos los derechos reservados.</p>
  </footer>

  <!-- Contenedor de mensajes -->
  <div id="popup"></div>
  <!-- Panel moderno de acciones (feedback para botones) -->
  <div id="action-panel" class="action-panel" aria-live="polite" aria-hidden="true"></div>

  <!-- Payment overlay and panel -->
  <div id="payment-overlay" class="payment-overlay" style="display:none"></div>
  <div id="payment-panel" class="payment-panel" style="display:none" aria-hidden="true"></div>

</body>
</html>
